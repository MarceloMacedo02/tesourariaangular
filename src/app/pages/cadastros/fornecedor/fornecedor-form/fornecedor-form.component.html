<!-- Start Breadcrumbs -->
<app-breadcrumbs [title]="isEditing ? 'Editar Fornecedor' : 'Novo Fornecedor'"
    [breadcrumbItems]="breadCrumbItems"></app-breadcrumbs>
<!-- End Breadcrumbs -->

<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title mb-0">{{ isEditing ? 'Editar Fornecedor' : 'Novo Fornecedor' }}</h4>
            </div>
            <div class="card-body">
                <form (ngSubmit)="onSubmit()" #fornecedorForm="ngForm">
                    <!-- Erros de validação -->
                    <div *ngIf="errors.length > 0" class="alert alert-danger">
                        <ul class="mb-0">
                            <li *ngFor="let error of errors">{{ error }}</li>
                        </ul>
                    </div>

                    <div class="row g-3">
                        <div class="col-lg-6">
                            <div class="mb-3">
                                <label for="nomeFantasia" class="form-label">
                                    Nome Fantasia *
                                </label>
                                <input type="text" class="form-control" id="nomeFantasia" name="nomeFantasia"
                                    [(ngModel)]="fornecedor.nomeFantasia" [disabled]="loading" required maxlength="100"
                                    placeholder="Informe o nome fantasia">
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="mb-3">
                                <label for="razaoSocial" class="form-label">
                                    Razão Social
                                </label>
                                <input type="text" class="form-control" id="razaoSocial" name="razaoSocial"
                                    [(ngModel)]="fornecedor.razaoSocial" [disabled]="loading" maxlength="150"
                                    placeholder="Informe a razão social">
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="mb-3">
                                <label for="cpfCnpj" class="form-label">
                                    CPF/CNPJ *
                                </label>
                                <input type="text" class="form-control" id="cpfCnpj" name="cpfCnpj"
                                    [(ngModel)]="fornecedor.cpfCnpj" [disabled]="loading" required
                                    placeholder="000.000.000-00 ou 00.000.000/0001-00" maxlength="18"
                                    (input)="fornecedor.cpfCnpj = formatarCpfCnpj(fornecedor.cpfCnpj || '')">
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="mb-3">
                                <label for="rg" class="form-label">
                                    RG
                                </label>
                                <input type="text" class="form-control" id="rg" name="rg" [(ngModel)]="fornecedor.rg"
                                    [disabled]="loading" maxlength="20" placeholder="00.000.000-0">
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="mb-3">
                                <label for="telefone" class="form-label">
                                    Telefone
                                </label>
                                <input type="text" class="form-control" id="telefone" name="telefone"
                                    [(ngModel)]="fornecedor.telefone" [disabled]="loading" placeholder="(00) 00000-0000"
                                    maxlength="15"
                                    (input)="fornecedor.telefone = formatarTelefone(fornecedor.telefone || '')">
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="mb-3">
                                <label for="email" class="form-label">
                                    Email
                                </label>
                                <input type="email" class="form-control" id="email" name="email"
                                    [(ngModel)]="fornecedor.email" [disabled]="loading" placeholder="email@exemplo.com"
                                    maxlength="100">
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="mb-3">
                                <label for="inscricaoEstadual" class="form-label">
                                    Inscrição Estadual
                                </label>
                                <input type="text" class="form-control" id="inscricaoEstadual" name="inscricaoEstadual"
                                    [(ngModel)]="fornecedor.inscricaoEstadual" [disabled]="loading" maxlength="20"
                                    placeholder="Ex: 123.456.789.112"
                                    (input)="fornecedor.inscricaoEstadual = formatarInscricaoEstadual(fornecedor.inscricaoEstadual || '')">
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="mb-3">
                                <label for="endereco" class="form-label">
                                    Endereço
                                </label>
                                <input type="text" class="form-control" id="endereco" name="endereco"
                                    [(ngModel)]="fornecedor.endereco" [disabled]="loading" maxlength="200"
                                    placeholder="Rua, número, cidade, estado">
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <div class="mb-3">
                                <label for="observacoes" class="form-label">
                                    Observações
                                </label>
                                <textarea class="form-control" id="observacoes" name="observacoes" rows="3"
                                    [(ngModel)]="fornecedor.observacoes" [disabled]="loading" maxlength="500"
                                    placeholder="Observações adicionais sobre o fornecedor"></textarea>
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="mb-3">
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="ativo" name="ativo"
                                        [(ngModel)]="fornecedor.ativo" [disabled]="loading">
                                    <label class="form-check-label" for="ativo">
                                        Ativo
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary" [disabled]="loading">
                            <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" role="status"
                                aria-hidden="true"></span>
                            {{ loading ? 'Salvando...' : (isEditing ? 'Atualizar' : 'Salvar') }}
                        </button>
                        <a [routerLink]="['/pages/cadastros/fornecedores']" class="btn btn-light">Cancelar</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>